<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>‰∫îÂçÅÈü≥„Ç´„Éº„Éâ„Ç¨„ÉÅ„É£</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@900&display=swap" rel="stylesheet">

<style>
html, body {
  margin: 0;
  width: 100vw;
  height: 100vh;
  background: #00E600;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: 'Noto Sans JP', sans-serif;
  overflow: hidden;
}

.container {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  padding-top: 15%;
}

/* ===== „Ç´„Éº„Éâ ===== */
.card {
  width: 220px;
  height: 280px;
  background: white;
  border-radius: 20px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 140px;
  margin: 20px auto;
  box-shadow: 0 20px 40px rgba(0,0,0,0.5);
  transition: transform 0.6s, filter 0.2s;
}

.flip {
  transform: rotateY(360deg) rotateZ(10deg) scale(1.05);
}

.flash {
  filter: brightness(2.8);
}

.bounce {
  animation: bounceCard 0.4s ease-out forwards;
}

@keyframes bounceCard {
  0% { transform: scale(1.05) translateY(0); }
  50% { transform: scale(1.2) translateY(-20px); }
  100% { transform: scale(1.05) translateY(0); }
}

/* ===== ÊñáÂ≠óÂº∑Âåñ ===== */
#result {
  font-weight: 900;
  text-shadow:
    0 0 8px #fff,
    0 6px 12px rgba(0,0,0,0.6),
    0 0 25px rgba(0,0,0,0.4);
  transition: transform 0.2s ease;
}

.pop {
  transform: scale(1.15);
}

/* ===== „Éú„Çø„É≥ ===== */
#drawBtn {
  position: absolute;
  bottom: 30%;
  padding: 16px 40px;
  font-size: 22px;
  border-radius: 30px;
  border: none;
  cursor: pointer;
  background: #ff4444;
  color: white;
}

/* ===== „Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥ ===== */
.countdown-wrapper {
  position: absolute;
  top: 15%;
  left: 50%;
  transform: translateX(-50%);
  width: 200px;
  height: 200px;
  z-index: 9999;
  display: none;
}

.countdown-wrapper svg {
  position: absolute;
  top: 0;
  left: 0;
  transform: rotate(-90deg);
}

.count-number {
  position: absolute;
  width: 200px;
  height: 200px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 90px;
  font-weight: bold;
  color: white;
  text-shadow: 0 0 25px black;
}

circle {
  fill: none;
  stroke-width: 12;
}

.progress-ring {
  stroke: #ff0000; /* üî¥ Ëµ§Âõ∫ÂÆö */
  stroke-linecap: round;
}
</style>
</head>

<body>

<div class="container">
  <div class="card" id="card">
    <div id="result">Ôºü</div>
  </div>
  <button id="drawBtn">„ÇÅ„Åè„ÇãÔºÅ</button>
</div>

<div class="countdown-wrapper" id="countdownWrapper">
  <svg width="200" height="200">
    <circle cx="100" cy="100" r="85" stroke="transparent"></circle>
    <circle class="progress-ring" id="progressRing" cx="100" cy="100" r="85"></circle>
  </svg>
  <div class="count-number" id="countNumber"></div>
</div>

<audio id="shuffleSound" src="shuffle.mp3"></audio>
<audio id="resultSound" src="result.mp3"></audio>

<script>
const gojyuon = [
  "„ÅÇ","„ÅÑ","„ÅÜ","„Åà","„Åä",
  "„Åã","„Åç","„Åè","„Åë","„Åì",
  "„Åï","„Åó","„Åô","„Åõ","„Åù",
  "„Åü","„Å°","„Å§","„Å¶","„Å®",
  "„Å™","„Å´","„Å¨","„Å≠","„ÅÆ",
  "„ÅØ","„Å≤","„Åµ","„Å∏","„Åª",
  "„Åæ","„Åø","„ÇÄ","„ÇÅ","„ÇÇ",
  "„ÇÑ","„ÇÜ","„Çà",
  "„Çâ","„Çä","„Çã","„Çå","„Çç",
  "„Çè","„Çí","„Çì",
  "„Åå","„Åé","„Åê","„Åí","„Åî",
  "„Åñ","„Åò","„Åö","„Åú","„Åû",
  "„Å†","„Å¢","„Å•","„Åß","„Å©",
  "„Å∞","„Å≥","„Å∂","„Åπ","„Åº",
  "„Å±","„Å¥","„Å∑","„Å∫","„ÅΩ"
];

const colors = ["#ff0000","#ff00ff","#0000ff","#00ccff","#ff9900","#00cc00"];

const result = document.getElementById("result");
const btn = document.getElementById("drawBtn");
const card = document.getElementById("card");
const shuffleSound = document.getElementById("shuffleSound");
const resultSound = document.getElementById("resultSound");

const wrapper = document.getElementById("countdownWrapper");
const number = document.getElementById("countNumber");
const ring = document.getElementById("progressRing");

const radius = 85;
const circumference = 2 * Math.PI * radius;
ring.style.strokeDasharray = circumference;

function getRandom() {
  return gojyuon[Math.floor(Math.random() * gojyuon.length)];
}

function getRandomColor(){
  return colors[Math.floor(Math.random()*colors.length)];
}

function startCountdown() {
  let count = 5;
  wrapper.style.display = "block";

  function tick() {
    number.textContent = count;

    ring.style.transition = "none";
    ring.style.strokeDashoffset = circumference;

    setTimeout(()=>{
      ring.style.transition = "stroke-dashoffset 1s linear";
      ring.style.strokeDashoffset = 0;
    },50);

    if(count===0){
      wrapper.style.display="none";
      card.classList.add("bounce");
      setTimeout(()=>card.classList.remove("bounce"),400);
      return;
    }

    count--;
    setTimeout(tick,1000);
  }

  tick();
}

function flashCard() {
  card.classList.add("flash");
  setTimeout(()=>card.classList.remove("flash"),200);
}

btn.addEventListener("click",()=>{

  btn.disabled=true;
  card.classList.remove("flip");
  result.textContent="Ôºü";
  result.style.color="#111";

  shuffleSound.loop=true;
  shuffleSound.currentTime=0;
  shuffleSound.play().catch(()=>{});

  const totalDuration=5000;
  const slowZone=4700;
  const startTime=Date.now();

  function shuffle(){
    const elapsed=Date.now()-startTime;

    if(elapsed>=totalDuration){

      shuffleSound.pause();
      shuffleSound.currentTime=0;

      const finalChar=getRandom();
      result.textContent=finalChar;
      result.style.color=getRandomColor();

      result.classList.add("pop");
      card.classList.add("flip");
      flashCard();
      resultSound.play().catch(()=>{});

      setTimeout(()=>{
        result.classList.remove("pop");
      },300);

      setTimeout(startCountdown,1000);
      btn.disabled=false;
      return;
    }

    result.textContent=getRandom();

    let interval;

    if(elapsed<slowZone){
      interval=120;
    }else{
      const progress=(elapsed-slowZone)/300;
      interval=120+Math.pow(progress,3)*800;
    }

    setTimeout(shuffle,interval);
  }

  shuffle();
});
</script>

</body>
</html>


